post:
  tags:
    - Auth
  summary: Iniciar sesi√≥n (Bearer Token)
  description: |
    Autentica a un usuario existente y devuelve un token de acceso Bearer.
    
    **üîê Autenticaci√≥n por tokens (API Mode):**
    
    Este endpoint usa autenticaci√≥n **stateless** con tokens Bearer (Laravel Sanctum API tokens).
    
    **Flujo de autenticaci√≥n:**
    
    1. **Hacer login** (este endpoint):
       ```
       POST http://localhost:8988/api/auth/login
       ```
       Recibes un token de acceso en la respuesta.
    
    2. **Usar el token** en peticiones posteriores:
       ```
       Authorization: Bearer {token}
       ```
    
    **Ventajas de autenticaci√≥n por tokens:**
    - ‚úÖ Funciona perfectamente en Postman, Insomnia, cURL
    - ‚úÖ Ideal para aplicaciones m√≥viles y APIs p√∫blicas
    - ‚úÖ No requiere cookies ni CSRF tokens
    - ‚úÖ Stateless (no depende de sesiones del servidor)
    - ‚úÖ Frontend y backend pueden estar en dominios diferentes
    
    **Para probar este endpoint:**
    - Usa Postman, Insomnia, cURL o cualquier cliente HTTP
    - Copia el token de la respuesta
    - √ösalo en el header `Authorization: Bearer {token}` para peticiones autenticadas
    
    **Validaciones aplicadas:**
    - Email: formato v√°lido, debe existir en el sistema
    - Contrase√±a: debe coincidir con la almacenada

  operationId: loginUser
  
  requestBody:
    required: true
    content:
      application/json:
        schema:
          type: object
          required:
            - email
            - password
          properties:
            email:
              type: string
              format: email
              description: Email del usuario registrado
              example: mortadelo@example.com
            password:
              type: string
              format: password
              description: Contrase√±a del usuario
              example: SecurePass123!
        
        examples:
          credencialesValidas:
            summary: ‚úÖ Credenciales v√°lidas
            description: Email y contrase√±a correctos de un usuario existente
            value:
              email: mortadelo@example.com
              password: SecurePass123!
          
          credencialesInvalidas:
            summary: ‚ùå Credenciales inv√°lidas
            description: Email o contrase√±a incorrectos
            value:
              email: mortadelo@example.com
              password: WrongPassword123!
          
          emailNoExiste:
            summary: ‚ùå Email no registrado
            description: El email no existe en la base de datos
            value:
              email: noexiste@email.com
              password: SecurePass123!
          
          camposVacios:
            summary: ‚ùå Campos vac√≠os
            description: Email o contrase√±a vac√≠os
            value:
              email: ""
              password: ""
          
          emailInvalido:
            summary: ‚ùå Email con formato inv√°lido
            description: El email no tiene un formato v√°lido
            value:
              email: correo-sin-arroba.com
              password: SecurePass123!

  responses:
    '200':
      description: Login exitoso - Token de acceso generado
      content:
        application/json:
          schema:
            type: object
            properties:
              message:
                type: string
                description: Mensaje de confirmaci√≥n del login
                example: Login successful.
              token:
                type: string
                description: Token de acceso Bearer para autenticar peticiones posteriores
                example: 1|a8K3mN9pQ2rT5vW8xY1zA4bC6dE9fG2hJ5kL8mN0pQ3rT6vW9xY2zA5bC8dE1fG4
              user:
                type: object
                description: Datos del usuario autenticado
                properties:
                  id:
                    type: string
                    format: uuid
                    description: ID √∫nico del usuario (UUID v4)
                    example: 974561d8-9ca9-4742-9efb-de27deab3b26
                  name:
                    type: string
                    description: Nombre del usuario
                    example: Mortadelo
                  email:
                    type: string
                    format: email
                    description: Email del usuario
                    example: mortadelo@example.com
          examples:
            loginExitoso:
              summary: Login exitoso
              value:
                message: Login successful.
                token: 1|a8K3mN9pQ2rT5vW8xY1zA4bC6dE9fG2hJ5kL8mN0pQ3rT6vW9xY2zA5bC8dE1fG4
                user:
                  id: 974561d8-9ca9-4742-9efb-de27deab3b26
                  name: Mortadelo
                  email: mortadelo@example.com

    '401':
      description: Credenciales inv√°lidas - Email o contrase√±a incorrectos
      content:
        application/json:
          schema:
            type: object
            properties:
              message:
                type: string
                description: Mensaje de error de autenticaci√≥n
          examples:
            credencialesInvalidas:
              summary: Credenciales incorrectas
              value:
                message: Invalid credentials.

    '422':
      description: Error de validaci√≥n - Datos inv√°lidos o incompletos
      content:
        application/json:
          schema:
            type: object
            properties:
              message:
                type: string
                description: Mensaje general del error de validaci√≥n
              errors:
                type: object
                description: Objeto con los errores de cada campo
                additionalProperties:
                  type: array
                  items:
                    type: string
          examples:
            camposVacios:
              summary: Campos requeridos vac√≠os
              value:
                message: Validation error. Please check the provided fields.
                errors:
                  email:
                    - The email field is required.
                  password:
                    - The password field is required.
            
            emailInvalido:
              summary: Email con formato inv√°lido
              value:
                message: Validation error. Please check the provided fields.
                errors:
                  email:
                    - The email has an invalid format. It should be like email@email.com

  x-code-samples:
    - lang: cURL
      source: |
        curl -X POST http://localhost:8988/api/auth/login \
          -H "Content-Type: application/json" \
          -H "Accept: application/json" \
          -d '{
            "email": "mortadelo@example.com",
            "password": "SecurePass123!"
          }'
        
        # Respuesta:
        # {
        #   "message": "Login successful.",
        #   "token": "1|a8K3mN9pQ2rT5vW8xY1zA4bC6dE9fG2hJ5kL8mN0pQ3rT6vW9xY2zA5bC8dE1fG4",
        #   "user": { ... }
        # }
        
        # Usar el token en peticiones posteriores:
        curl -X GET http://localhost:8988/api/protected-endpoint \
          -H "Authorization: Bearer 1|a8K3mN9pQ2rT5vW8xY1zA4bC6dE9fG2hJ5kL8mN0pQ3rT6vW9xY2zA5bC8dE1fG4"
    
    - lang: JavaScript (Fetch)
      source: |
        // Hacer login
        const response = await fetch('http://localhost:8988/api/auth/login', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Accept': 'application/json'
          },
          body: JSON.stringify({
            email: 'mortadelo@example.com',
            password: 'SecurePass123!'
          })
        });
        
        const data = await response.json();
        const token = data.token;
        
        // Guardar el token (localStorage, sessionStorage, etc.)
        localStorage.setItem('authToken', token);
        
        // Usar el token en peticiones posteriores
        const protectedResponse = await fetch('http://localhost:8988/api/protected-endpoint', {
          headers: {
            'Authorization': `Bearer ${token}`,
            'Accept': 'application/json'
          }
        });
    
    - lang: JavaScript (Axios)
      source: |
        // Hacer login
        const response = await axios.post('http://localhost:8988/api/auth/login', {
          email: 'mortadelo@example.com',
          password: 'SecurePass123!'
        });
        
        const token = response.data.token;
        
        // Guardar el token
        localStorage.setItem('authToken', token);
        
        // Configurar Axios para usar el token en todas las peticiones
        axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;
        
        // Usar en peticiones posteriores
        const protectedResponse = await axios.get('http://localhost:8988/api/protected-endpoint');
    
    - lang: Python (requests)
      source: |
        import requests
        
        # Hacer login
        response = requests.post(
            'http://localhost:8988/api/auth/login',
            json={
                'email': 'mortadelo@example.com',
                'password': 'SecurePass123!'
            }
        )
        
        data = response.json()
        token = data['token']
        
        # Usar el token en peticiones posteriores
        protected_response = requests.get(
            'http://localhost:8988/api/protected-endpoint',
            headers={'Authorization': f'Bearer {token}'}
        )
